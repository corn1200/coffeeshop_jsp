CREATE TABLE TBL_PRODUCT_01 (
    PCODE VARCHAR2(10) NOT NULL,
    NAME VARCHAR2(20),
    COST NUMBER(10),
    CONSTRAINT PK_PRODUCT PRIMARY KEY(PCODE)
);

CREATE TABLE TBL_SHOP_01 (
    SCODE VARCHAR2(10) NOT NULL,
    SNAME VARCHAR2(20),
    CONSTRAINT PK_SHOP PRIMARY KEY(SCODE)
);

CREATE TABLE TBL_SALELIST_01 (
    SALENO NUMBER(10) NOT NULL,
    PCODE VARCHAR2(10) NOT NULL,
    SALEDATE DATE,
    SCODE VARCHAR2(10) NOT NULL,
    AMOUNT NUMBER(10),
    CONSTRAINT PK_SALELIST PRIMARY KEY(SALENO)
);

INSERT INTO TBL_PRODUCT_01(PCODE, NAME, COST) VALUES('AA01', '아메리카노', 3000);
INSERT INTO TBL_PRODUCT_01(PCODE, NAME, COST) VALUES('AA02', '에스프레소', 3500);
INSERT INTO TBL_PRODUCT_01(PCODE, NAME, COST) VALUES('AA03', '카페라떼', 4000);
INSERT INTO TBL_PRODUCT_01(PCODE, NAME, COST) VALUES('AA04', '카라멜마끼', 4500);
INSERT INTO TBL_PRODUCT_01(PCODE, NAME, COST) VALUES('AA05', '카푸치노', 5000);
INSERT INTO TBL_PRODUCT_01(PCODE, NAME, COST) VALUES('AA06', '초코롤케익', 6000);
INSERT INTO TBL_PRODUCT_01(PCODE, NAME, COST) VALUES('AA07', '녹차롤케익', 6500);
INSERT INTO TBL_PRODUCT_01(PCODE, NAME, COST) VALUES('AA08', '망고쥬스', 7000);
INSERT INTO TBL_PRODUCT_01(PCODE, NAME, COST) VALUES('AA09', '핫초코', 2500);

INSERT INTO TBL_SHOP_01(SCODE, SNAME) VALUES('S001', '강남점');
INSERT INTO TBL_SHOP_01(SCODE, SNAME) VALUES('S002', '강서점');
INSERT INTO TBL_SHOP_01(SCODE, SNAME) VALUES('S003', '강동점');
INSERT INTO TBL_SHOP_01(SCODE, SNAME) VALUES('S004', '강북점');
INSERT INTO TBL_SHOP_01(SCODE, SNAME) VALUES('S005', '동대문점');
INSERT INTO TBL_SHOP_01(SCODE, SNAME) VALUES('S006', '인천점');

INSERT INTO TBL_SALELIST_01(SALENO, PCODE, SALEDATE, SCODE, AMOUNT) VALUES(100001, 'AA01', '20180902', 'S001', 50);
INSERT INTO TBL_SALELIST_01(SALENO, PCODE, SALEDATE, SCODE, AMOUNT) VALUES(100002, 'AA03', '20180902', 'S002', 40);
INSERT INTO TBL_SALELIST_01(SALENO, PCODE, SALEDATE, SCODE, AMOUNT) VALUES(100003, 'AA04', '20180902', 'S002', 20);
INSERT INTO TBL_SALELIST_01(SALENO, PCODE, SALEDATE, SCODE, AMOUNT) VALUES(100004, 'AA04', '20180902', 'S001', 30);
INSERT INTO TBL_SALELIST_01(SALENO, PCODE, SALEDATE, SCODE, AMOUNT) VALUES(100005, 'AA05', '20180902', 'S004', 40);
INSERT INTO TBL_SALELIST_01(SALENO, PCODE, SALEDATE, SCODE, AMOUNT) VALUES(100006, 'AA03', '20180902', 'S004', 30);
INSERT INTO TBL_SALELIST_01(SALENO, PCODE, SALEDATE, SCODE, AMOUNT) VALUES(100007, 'AA01', '20180902', 'S003', 40);
INSERT INTO TBL_SALELIST_01(SALENO, PCODE, SALEDATE, SCODE, AMOUNT) VALUES(100008, 'AA04', '20180902', 'S004', 10);
INSERT INTO TBL_SALELIST_01(SALENO, PCODE, SALEDATE, SCODE, AMOUNT) VALUES(100009, 'AA01', '20180902', 'S003', 20);
INSERT INTO TBL_SALELIST_01(SALENO, PCODE, SALEDATE, SCODE, AMOUNT) VALUES(100010, 'A005', '20180902', 'S003', 30);
INSERT INTO TBL_SALELIST_01(SALENO, PCODE, SALEDATE, SCODE, AMOUNT) VALUES(100011, 'AA01', '20180902', 'S001', 40);
INSERT INTO TBL_SALELIST_01(SALENO, PCODE, SALEDATE, SCODE, AMOUNT) VALUES(100012, 'AA03', '20180902', 'S002', 50);
INSERT INTO TBL_SALELIST_01(SALENO, PCODE, SALEDATE, SCODE, AMOUNT) VALUES(100013, 'AA04', '20180902', 'S002', 50);
INSERT INTO TBL_SALELIST_01(SALENO, PCODE, SALEDATE, SCODE, AMOUNT) VALUES(100014, 'AA05', '20180902', 'S004', 20);
INSERT INTO TBL_SALELIST_01(SALENO, PCODE, SALEDATE, SCODE, AMOUNT) VALUES(100015, 'AA01', '20180902', 'S003', 30);



SELECT SALELIST.SALENO, SALELIST.PCODE,
TO_CHAR(SALELIST.SALEDATE, 'yyyy-MM-dd'),
SALELIST.SCODE, PRODUCT.NAME, 
SALELIST.AMOUNT, PRODUCT.COST
FROM tbl_product_01 PRODUCT, 
tbl_salelist_01 SALELIST, tbl_shop_01 SHOP
WHERE SHOP.SCODE = SALELIST.SCODE 
AND PRODUCT.PCODE = SALELIST.PCODE
ORDER BY SALELIST.SALENO ASC;



SELECT SHOP.SCODE, SHOP.SNAME, 
SUM(SALELIST.AMOUNT * PRODUCT.COST)
FROM tbl_salelist_01 SALELIST, 
tbl_shop_01 SHOP, tbl_product_01 PRODUCT
WHERE SALELIST.SCODE = SHOP.SCODE 
AND SALELIST.PCODE = PRODUCT.PCODE
GROUP BY SHOP.SCODE, SHOP.SNAME
ORDER BY SHOP.SCODE ASC;



SELECT PRODUCT.PCODE, PRODUCT.NAME,
SUM(PRODUCT.COST * SALELIST.AMOUNT)
FROM tbl_product_01 PRODUCT, 
tbl_salelist_01 SALELIST
WHERE SALELIST.PCODE = PRODUCT.PCODE
GROUP BY PRODUCT.PCODE, PRODUCT.NAME
ORDER BY PRODUCT.PCODE ASC;